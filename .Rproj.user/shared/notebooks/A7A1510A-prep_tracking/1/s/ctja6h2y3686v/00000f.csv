"0","frame_of_tackle_opp  <- data.frame(matrix(ncol = 27, nrow = 0))"
"0","colnames(frame_of_tackle_opp) <- colnames(work_df)"
"0","print(length(unique(work_df$game_playId)))"
"1","[1]"
"1"," 41"
"1","
"
"0","counter = 0 "
"0","counter_c = c()"
"0","counter_n = c()"
"0",""
"0","for (game_play in unique(work_df$game_playId)){"
"0","  #for each game id combo"
"0","  counter = counter + 1"
"0","  print(counter)"
"0","  play_data <- work_df %>% filter(game_playId == game_play)"
"0","  frame_tackle_occured <- play_data %>% filter(event == 'tackle')%>%pull(frameId)"
"0","  frame_tackle_occured <- frame_tackle_occured[1]           "
"0","  if (length(frame_tackle_occured) != 0) {"
"0","  #if (!('out_of_bounds' %in% unique(play_data$event) & ""qb_slide"" %in% unique(play_data$event))) {"
"0","    #out of bounds is ruled a tackle, but this is not a contact tackle that we will consider, also qb slide we wont count"
"0","  "
"0","  players_w_tackle_opp <- play_data %>% filter(had_tackle_opp ==1)"
"0","  #if the player has a tackle opp"
"0","  for (player in unique(players_w_tackle_opp$nflId)) {"
"0","    #go thru list of players with opp"
"0","    player_data <-  play_data %>% filter(nflId == player)"
"0","    if (player_data$made_first_contact[1] == 1 & !is.na(player_data$made_first_contact[1])){"
"0","      #this means when first contact was made is the frame we will examine"
"0","      dummy_table <- play_data %>% filter(event == 'first_contact')"
"0","    #take all tracking data from when first contact was made"
"0","      frame_of_tackle_opp <- rbind(frame_of_tackle_opp, dummy_table)"
"0","      counter_c = append(counter_c, game_play)}"
"0","      "
"0","    else{"
"0","      #10 frames before the tackle is made"
"0","      player_data <- player_data %>% filter( frameId < frame_tackle_occured, frameId > (frame_tackle_occured - 10))"
"0","      #look at back half of play, this avoids potential of a player presnap            lining up close"
"0","      #.9705 is the median distance for when a player is considered in contact"
"0","      player_data$dev_median <- abs(player_data$dist_from_ball - .9705)"
"0","      frame_to_keep <- player_data %>% filter( dev_median == min(player_data$dev_median)) %>% pull(frameId)"
"0","      #player data when the distance from ball is closest to the median"
"0","      #we are essentially projecting when contact is made"
"0","      #at this frame filter the tracking data, this is when contact is made"
"0","      dummy_table <- work_df %>% filter(game_playId == game_play,frameId == frame_to_keep)"
"0","      frame_of_tackle_opp <- rbind(frame_of_tackle_opp, dummy_table)"
"0","      counter_n = append(counter_n, game_play)"
"0","      }}"
"0","}}"
"1","[1]"
"1"," 1"
"1","
"
"1","[1]"
"1"," 2"
"1","
"
"1","[1]"
"1"," 3"
"1","
"
"1","[1]"
"1"," 4"
"1","
"
"1","[1]"
"1"," 5"
"1","
"
"1","[1]"
"1"," 6"
"1","
"
"1","[1]"
"1"," 7"
"1","
"
"1","[1]"
"1"," 8"
"1","
"
"1","[1]"
"1"," 9"
"1","
"
"1","[1]"
"1"," 10"
"1","
"
"1","[1]"
"1"," 11"
"1","
"
"1","[1]"
"1"," 12"
"1","
"
"2","Warning: [38;5;232mThere was 1 warning in `filter()`.[39m
[38;5;232m[36mi[38;5;232m In argument: `dev_median == min(player_data$dev_median)`.[39m
Caused by warning in `min()`:
[33m![39m no non-missing arguments to min; returning Inf"
"1","[1m[33mError[39m in `filter()`:[22m
[38;5;232m[36mi[38;5;232m In argument: `frameId == frame_to_keep`.[39m
[1mCaused by error:[22m
[38;5;232m[33m![38;5;232m `..2` must be of size 1407439 or 1, not size 0.[39m
Backtrace:
[90m 1. [39mwork_df %>% ...
[90m 9. [39m[1mdplyr[22m:::dplyr_internal_error(...)
"
