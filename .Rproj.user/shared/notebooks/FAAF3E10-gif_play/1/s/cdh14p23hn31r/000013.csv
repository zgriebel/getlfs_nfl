"0","for (playId in unique(df$playId)){"
"0","  single_play <- df[df$playId == playId,]"
"0","  for (single_time in unique(single_play$time)){"
"0","    time_ball_data <- single_play[single_play$displayName == ""ball"",]"
"0","    time_player_data <- single_play[single_play$displayName != ""ball"",]"
"0","    "
"0","    ball_x <- time_ball_data[time_ball_data$time == single_time,]$x"
"0","    ball_y <- time_ball_data[time_ball_data$time == single_time,]$y"
"0","    time_player_data <- single_time %>% filter(displayName != ""ball"") %>%"
"0","    mutate(dist_from_ball = sqrt(((ball_x-x)^2)+((ball_y-y)^2)) )"
"0","  "
"0","    time_player_data$has_ball = 0"
"0","    time_player_data$closest_defender = 0"
"0","  "
"0","    min_dist_o = min(time_player_data[time_player_data$possessionFlag == 1,]$dist_from_ball)"
"0","  "
"0","    time_player_data[time_player_data$dist_from_ball == min_dist_o,]$has_ball = 1"
"0","  "
"0","    min_dist_d = min(time_player_data[time_player_data$possessionFlag == 0,]$dist_from_ball)"
"0",""
"0","    time_player_data[time_player_data$dist_from_ball == min_dist_d,]$closest_defender = 1"
"0","  "
"0","  "
"0","  "
"0","    time_player_data <- select( time_player_data, c('dist_from_ball', 'closest_defender', 'has_ball', 'playId', 'time', 'displayName' ))"
"0","    "
"0","    df<- left_join(df, time_player_data, by = c('playId' = 'playId', 'frame'='frame', 'displayName' = 'displayName' ))"
"0","  }"
"0","}"
"2","Error in UseMethod(""filter"") : 
  no applicable method for 'filter' applied to an object of class ""character""
"
